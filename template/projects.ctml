<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8"/>
    <title>Autobuild</title>
    <link rel="stylesheet" type="text/css" @href="/static/autobuild-server/main.css" href="../static/main.css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <meta name="description" content="Autobuild reports" />
    <meta name="robots" content="index, follow" />
    <meta name="viewport" content="width=device-width" />
  </head>
  <body>
    <header>
      <a @href="/" href="#"><h1>Autobuild</h1></a>
      <div class="system-load">
        <div class="cpu"><label>CPU</label><span class="percentage">0</span><div class="bar"><div style="width:0%"></div></div></div>
        <div class="ram"><label>RAM</label><span class="percentage">0</span><div class="bar"><div style="width:0%"></div></div></div>
        <div class="mem"><label>MEM</label><span class="percentage">0</span><div class="bar"><div style="width:0%"></div></div></div>
      </div>
      <nav class="global-options">
        <a class="notifications" title="Toggle update notifications"><i class="fa fa-bell"></i></a>
      </nav>
    </header>
    <form @action="/api/autobuild/project/add" id="add-project" method="post">
      <input name="name" type="text" placeholder="name" title="Name, automatically determined from remote." />
      <input name="remote" type="url" placeholder="https://github.com/..." title="Remote" required />
      <input name="branch" type="text" placeholder="master" title="Branch" />
      <button type="submit"><i class="fa fa-plus-circle"></i></button>
    </form>
    <main iterate="projects">
      <article class="project" lquery="(data :name name)">
        <header>
          <h2 class="name" lquery="(text name)">Some Repo</h2>
          <a class="link" href="#" lquery="(text remote) (attr :href remote)">online.com</a>
          <span class="branch" lquery="(text branch)">Branch</span>
          <nav>
            <a href="#" title="Pull" @href='(#?"/api/autobuild/project/pull?project={0}" name)'><i class="fa fa-download"></i></a>
            <a href="#" title="Populate builds" class="confirm" @href='(#?"/api/autobuild/project/populate?project={0}" name)'><i class="fa fa-history"></i></a>
            <a href="#" title="Clean out old builds (delete all but the most recent 5)" class="confirm" @href='(#?"/api/autobuild/project/clean?project={0}" name)'><i class="fa fa-recycle"></i></a>
            <a href="#" title="Delete this project" class="confirm" @href='(#?"/api/autobuild/project/delete?project={0}" name)'><i class="fa fa-trash"></i></a>
            <a href="#" title="Start/stop automatic building" @href='(#?"/api/autobuild/project/toggle-watch?project={0}" name)'>
              <i class="fa fa-circle" lquery='(add-class (if watch "watching" "not-watching"))'></i>
            </a>
          </nav>
        </header>
        <section class="builds">
          <div class="header">
            <span class="status">Status</span>
            <span class="hash">Commit</span>
            <span class="message">Message</span>
            <span class="duration">Duration</span>
            <span class="start">Start Date</span>
            <span class="actions"></span>
          </div>
          <ul iterate="builds">
            <li class="build" lquery="(data :commit commit) (data :project (name project)) (data :status status)">
              <a class="status" href="#" @href='(#?"/project/{0}/build/{1}" (name project) commit)'><i class="fa" lquery="(add-class status-icon)"></i></a>
              <a class="hash" href="#" @href='(#?"/project/{0}/build/{1}" (name project) commit)' lquery="(text short-commit)">c0mm1t</a>
              <p class="message short" lquery="(text short-message)">Something Descriptive</p>
              <time class="duration" lquery="(text duration)">2:00:14</time>
              <time class="start" lquery="(text start) (attr :datetime start)">2015.09.27 13:19:38</time>
              <nav class="actions">
                <a href="#" title="Start build" @href='(#?"/api/autobuild/project/build/start?project={0}&build={1}" (name project) commit)'><i class="fa fa-arrow-circle-right"></i></a>
                <a href="#" title="Stop build" @href='(#?"/api/autobuild/project/build/stop?project={0}&build={1}" (name project) commit)'><i class="fa fa-times-circle"></i></a>
                <a href="#" title="Delete this build" class="confirm" @href='(#?"/api/autobuild/project/build/delete?project={0}&build={1}" (name project) commit)'><i class="fa fa-trash"></i></a>
                <a href="#" title="View on GitHub" lquery="(attr :href remote)"><i class="fa fa-github"></i></a>
              </nav>
            </li>
          </ul>
          <form @action="/api/autobuild/project/build/add" id="add-build" method="post">
            <input type="hidden" name="project" lquery="(val name)" />
            <input type="text" name="commit" placeholder="Commit hash" required />
            <button type="submit"><i class="fa fa-plus-circle"></i></button>
          </form>
        </section>
      </article>
    </main>
    <footer>
      &copy; Shirakumo
    </footer>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="../main.js" @src="/static/autobuild-server/main.js"></script>
  </body>
</html>
